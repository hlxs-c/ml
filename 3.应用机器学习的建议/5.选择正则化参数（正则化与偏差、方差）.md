# 选择正则化参数（正则化与偏差、方差）

## 1.问题引入（以线性回归为例）

![image-20240107101916608](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240107101916608.png)

> $\lambda$ 是正则化参数，它控制在 `保持参数$\mathbf{w}$ 较小` 与 `很好地拟合训练数据` 两个目标之间进行权衡

在线性回归中，如果我们采用正则化，则正则化参数的大小将影响我们训练得到的模型：

- 正则化参数过大（左图）：
  - 如果正则化参数 $\lambda$ 过大，则训练之后模型参数$\mathbf{w}$ 将会非常小，即最终得到的参数 $w_1、w_2、...$ 这些参数都将非常接近于0， 则模型最终将大约是一个常数值（即$f \approx b$），所以会得到如左图中的模型；
  - 正则化参数过大训练得到的模型具有很高的偏差并且它不拟合训练数据，而因为它在训练集上的表现很差，所以 $J_{train}$ 将会很大；
- 正则化参数过小（右图）：
  - 如果正则化参数 $\lambda$ 过小，则相当于只是拟合训练了一个没有正则化的模型，所以最终可能会得到一个过拟合的模型，如右图中的过度拟合数据的曲线；
  - 正则化参数过小训练得到的模型非常拟合训练数据，所以$J_{train}$ 很小，但在未见过的数据上表现很差，所以$J_{cv}$ 很大，且$J_{cv} \gt \gt J_{train}$；
- 正则化参数合适（中图）：
  - 如果正则化参数合适，则将会拟合训练得到一个较好的模型，此时模型在训练集和验证集上表现都将较为良好，即$J_{train}、J_{cv}$ 都将很小；



那么我们应该**如何确定一个良好的用于正则化的正则化参数$\lambda$ 呢？**

与 [选择模型](C:\Data\Markdown\MachineLearning\3.应用机器学习的建议\3.模型选择和交叉验证.md) 类似，**交叉验证** 也为我们提供了一种方法。



## 2. 选择良好的正则化参数$\lambda$

选择良好的正则化参数$\lambda$ 的过程类似于在使用**交叉验证** 选择模型的过程。

1. 列出一系列待选择的正则化参数 $\lambda$
   - 一般待选择的系列正则化参数之间呈倍数关系，例如 $0, 0.1, 0.02, 0.04, 0.08 ....$
2. 使用一系列带选择的正则化参数 $\lambda$ 训练得到一系列模型（也即一系列模型参数 $(\mathbf{w}^{(1)},b^{(1)})、(\mathbf{w}^{(2)},b^{(2)})、...$）
3. 使用交叉`验证集` 对训练得到的一系列模型进行评估
4. 选择在交叉验证集上表现最好的模型，即 $J_{cv}$ 最小的模型
5. 在 `测试集`上对最终选择的模型进行性能评估，评估其在未曾见过的数据上的泛化能力（即计算 $J_{test}$并进行分析

![image-20240107104413443](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240107104413443.png)



使用**交叉验证**方法选择正则化参数$lambda$ 时，实际上是在尝试许多不同的 $\lambda$值，并评估许多不同点的交叉验证误差，然后希望选择一个具有最低交叉验证误差的值，这将有希望选择出一个合适的正则化参数。



## 3.理解正则化参数如何影响训练误差和验证误差

![image-20240107104733574](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240107104733574.png)

- 如果正则化参数 $\lambda$ 很小甚至为0，在这种情况下，将会训练得到一个高方差（过拟合）的模型，那么$J_{train}$ 会很小而 $J_{cv}$ 会很大，因为它在训练数据集上表现很好但在交叉验证集上表现很差；
- 如果正则化参数 $\lambda$ 很大，在这种情况下，将会训练得到一个高偏差（欠拟合）的模型，由于它欠拟合数据，则 $J_{train}$ 会很高并且 $J_{cv}$ 也会很高；
- 查看 $J_{train}$ 随着 $\lambda$ 的变化曲线，可以发现 $J_{train}$ 随着正则化参数$\lambda$的变大而变大，因为在优化成本函数中，正则化参数$\lambda$ 越大，则算法将试图保持模型参数$\mathbf{w}$ 的平方很小，也就是说，正则化参数$\lambda$ 越大，在训练优化过程中对拟合训练集数据的关注就越少；
- 查看 $J_{cv}$ 随着 $\lambda$ 的变化曲线，可以发现 $J_{cv}$ 随着正则化参数 $\lambda$ 的变大先减小后增大；