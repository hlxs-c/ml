# 多类别分类：一对多

## 问题引出

对于二元分类来说，数据集可能是像这样：

![img](http://www.ai-start.com/ml2014/images/68f56679a2113c7857ab9dd2afebcba8.png)

对于一个多类分类问题，我们的数据集或许看起来像这样：

![img](http://www.ai-start.com/ml2014/images/54d7903564b4416305b26f6ff2e13c04.png)

在上图中的右图中，我们**用3种不同的符号来代表3个类别，问题就是给出3个类别的数据集，我们如何得到一个学习算法来进行分类呢**？





## 解决问题

我们已经知道如何 **使用逻辑回归进行二元分类**，例如对于只有2个特征的数据集来说，我们可以使用直线来将数据集一分为二（正类和负类）：

![image-20231202132913223](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20231202132913223.png)

我们可以将 **二元分类的思想** 扩展到 **多类分类问题** 上。



![img](http://www.ai-start.com/ml2014/images/450a83c67732d254dbac2aeeb8ab910c.png)

现在我们有一个数据集，如上图所示，数据集有3个类别，用三角形表示$y=1$，方框表示$y=2$，叉叉表示$y=3$。我们下面要做的就是使用这个数据集，将其分割成 **$3$** 个独立的**二元分类**问题。



我们先从三角形代表的类别$1$ 开始，我们将创建一个新的 **”伪“训练集**，其中

- 类别$2$ 和 类别$3$ 被设定为 **负类**，
- 类别$1$ 被设定为**正类**

这样就创建了一个 **新的数据集**，如下图中的右图所示，其中三角形为正样本，圆形为样本：

![image-20231202133922227](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20231202133922227.png)

上图中三角形为正样本，故设其$y=1$，圆形为负样本，故设其$y=0$，

然后现在我们要做的是——拟合一个分类器，称其为 $f_{\mathbf{w},b}^{(1)}(\mathbf{x})$，其中$f_{\mathbf{w},b}^{(1)}(\mathbf{x})$ 中的上标 $(1)$表示**类别1**。

使用上述 **新的数据集** 去训练一个 **标准的逻辑回归分类器 $f_{\mathbf{w},b}^{(1)}(\mathbf{x})$**，这样我们就可以得到一个 **判定边界**，例如对于上图的数据集来说有如下 **判定边界**：

![image-20231202134404973](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20231202134404973.png)

接着，我们对 **类别2**进行同样的处理：

- 将正方性样本设置为 **正类别**
- 将其他样本设置为 **负类别**

创建出一个新的数据集，并拟合 **第二个逻辑回归分类器$f_{\mathbf{w},b}^{(2)}(\mathbf{x})$**，其中 $f_{\mathbf{w},b}^{(2)}(\mathbf{x})$ 中的上标 $(2)$ 表示**类别2**（也即我们把正方性类别当作正类别），然后我们会得到一个新的 **判定边界**，如下图所示：

![image-20231202134858204](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20231202134858204.png)

最后，我们对 **类别3** 进行同样的处理：

- 将叉叉样本设置为 **正类别**
- 将其他样本设置为 **负类别**

创建出一个新的数据集，并拟合 **第三个逻辑回归分类器$f_{\mathbf{w},b}^{(3)}(\mathbf{x})$**，其中 $f_{\mathbf{w},b}^{(3)}(\mathbf{x})$ 中的上标 $(3)$ 表示**类别3**（也即我们把叉叉类别当作正类别），然后我们会得到一个新的 **判定边界**，如下图所示：

![image-20231202135031741](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20231202135031741.png)



通过上述步骤，我们拟合出了三个分类器
$$
f_{\mathbf{w},b}^{(i)}(\mathbf{x})  \\
(i=1,2,3)
$$
我们拟合分类器$f_{\mathbf{w},b}^{(i)}(\mathbf{x})$ 来尝试估计出 **在给定 $\mathbf{x} 和 (\mathbf{w},b)$ 时，$y=i$ 的概率**，每个分类器都针对其中**一种类别**（一种情况）进行训练。



最后，为了做出预测，我们给出一个新的输入值 $\mathbf{x}$，期望获得一个预测，我们要做的就是将 $\mathbf{x}$ 输入三个分类器，并选择概率值最大的结果，也即选择这三个分类器中可信度最高、效果最好的结果。
$$
max(f_{\mathbf{w},b}^{(i)}(\mathbf{x})) \\
(i = 1,2,3)
$$
