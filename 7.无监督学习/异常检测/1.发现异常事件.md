# 发现异常事件

**异常检测算法** 会查看未标记的正常事件数据集，从而学会检测异常或异常事件或发出危险信号。



## 1. 引入

下面以 **研究使用 `异常检测` 来检测正在制造的飞机发动机可能存在的问题** 为例：

![image-20240113161757254](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240113161757254.png)

由于飞机发动机制造商并没有制造那么多坏发动机，因此，更容易收集的数据类型是表现良好的发动机。例如，如果制造了 $m$ 台飞机发动机，则可以收集关于这些 $m$ 台发动机如何运行的特征 $x_1, x_2$， 这些发动机可能大多数都表现的很好而不是具有缺陷。

在这个例子中，**异常检测** 的问题是：在学习算法看到这 $m$ 个训练样本之后，飞机引擎通常产生多少热量或振动多少？如果一个全新的飞机发动机组装成功之后（例如由$x_{test}$ 给出其特征向量），我们想知道这个发动机是否和之前制造的发动机相似？



将训练数据集可视化：

<img src="C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240113161741464.png" alt="image-20240113161741464" style="zoom:50%;" />

此时，给出一个新的测试样本（下图中被蓝色圈中的样本）：

<img src="C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240113161958629.png" alt="image-20240113161958629" style="zoom:50%;" />

可以看到这个测试样本和训练样本非常接近（相似），则由于训练样本是表现良好的样本，则我们可以认为该测试样本是没问题的；

但是，如果给出一个新的测试样本（下图中黑色圈中的样本）：

<img src="C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240113162254837.png" alt="image-20240113162254837" style="zoom:50%;" />

可以看到该样本和训练样本相差较大，故可以认为该样本是反常样本。



## 2. 密度估计

**执行异常检测的最常见的方法是通过密度估计的技术**。

**密度估计** 是一种统计方法，用于估计数据集中样本点的**概率密度函数**（Probability Density Function，`PDF`）。它的目标是通过观察已知数据的分布情况，推断出数据中未观察到的潜在分布。

对于异常检测任务而言，密度估计可以用于建模正常样本的分布，并通过计算新样本的概率密度来判断其是否属于正常的数据集。

常见的密度估计方法包括：

1. **参数方法**：参数方法假设数据服从某个特定的概率分布，例如高斯分布、指数分布等。在这种方法中，通过最大似然估计或贝叶斯估计等技术，利用已知数据集来估计分布的参数。然后，可以使用估计的参数来计算新样本的概率密度。
2. **非参数方法**：非参数方法不对数据分布做具体的假设，而是直接从数据中估计概率密度。其中，最常见的方法之一是核密度估计（Kernel Density Estimation，`KDE`），它通过在每个样本点周围放置核函数，并将核函数的贡献进行叠加来估计概率密度。核密度估计方法不需要假设特定的概率分布，因此对于任意分布的数据都可以进行估计。
3. **混合模型**：混合模型将多个概率分布组合起来，用于更准确地建模数据的分布。每个分布称为混合模型的一个组件，而每个组件都有自己的权重。通过估计每个组件的参数和权重，可以得到整个数据集的概率密度估计。

密度估计方法是在异常检测中最常用的技术之一，它可以捕捉到正常样本的分布情况，并通过与新样本的概率密度比较来识别异常点。



