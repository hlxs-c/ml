# 二进制标签

推荐系统或协同过滤算法的许多重要应用都涉及到二进制标签，而不是用户给出的评分，那么应该如何将算法泛化到二进制标签的训练集上？

**答案**：这与从线性回归过渡到逻辑回归，从预测数字到预测二进制标签的过程相似。



### 更改模型

在预测数字时，使用的是线性回归模型：
$$
\text{Predict $y^{(i,j)}$} = \mathbf{w}^{(j)}·\mathbf{x}^{(i)} + b^{(j)}
$$
而对于二进制标签，预测的输出应该是一个概率（即 $p(y^{(i,j)}=1)$）：
$$
p(y^{(i,j)}=1) = g(\mathbf{w}^{(j)}·\mathbf{x}^{(i)} + b^{(j)}) \\ 
= sigmod(\mathbf{w}^{(j)}·\mathbf{x}^{(i)} + b^{(j)})
\\\\
其中 g(z)=sigmod(z) = \frac{1}{1+e^{-z}}
$$


### 更改使用的损失函数

为了构建此算法，还必须将损失函数从 **平方误差**损失函数 修改为 跟适合逻辑回归模型的二元标签的成本函数——**交叉熵损失函数**：

- 首先，有$f_{(\mathbf{w},b,\mathbf{x})} = g(\mathbf{w}^{(j)}·\mathbf{x}^{(i)} + b^{(j)})$

- 则，对于单个样本的损失函数为：

  - $$
    L(f_{(\mathbf{w},b,\mathbf{x})}, y^{(i,j)}) = 
    -y^{(i,j)}log(f_{(\mathbf{w},b,\mathbf{x})}) - (1-y^{(i,j)})log(1-f_{(\mathbf{w},b,\mathbf{x})})
    $$

- 对于所有样本的总体损失函数为：

  - $$
    J(\mathbf{w},b,\mathbf{x}) = \sum_{(i,j):r(i,j)=1} L(f_{(\mathbf{w},b,\mathbf{x})}, y^{(i,j)})
    $$

