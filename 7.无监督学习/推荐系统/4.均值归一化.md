# 均值归一化

![image-20240115164744962](C:\Users\chen\AppData\Roaming\Typora\typora-user-images\image-20240115164744962.png)

如上图所示，给出的样本中，有一个用户没有对任何一步电影进行评分。则由于当我们在这个数据集上训练协同过滤算法时，由于我们使用了正则化项，则由于用户5没有对任何电影进行评分，则可能会使最终得到的参数 $\mathbf{w}^{(5)} = [0,0], b^{(5)}=0$（这是因为用户5没有对任何电影进行评分，则其参数 $\mathbf{w}^{(5)}, b^{(5)}$ 不会影响损失函数中的第一项，而正则化项则会使参数 $\mathbf{w}^{(5)}$ 尽可能小）。同时由于我们的模型为 $f_{\mathbf{w},b}=w·x + b$，则预测用户5对各种电影的评分都将为0。

因此，经过上述分析可知，如果有一个尚未对任何内容进行评分的新用户，则该算法将预测新用户对所有的内容打0分，这并不是一个很好的预测。

而**均值归一化** 则可以帮助协同过滤算法为尚未对任何内容进行评分的用户更好地预测评分。



为了进行 **均值归一化**：

- 首先我们要做的是获取所有评分数据，并为每部电影计算给出的平均评分

  - 注意：只计算已经给出评分的平均值，例如对于上述第一部电影来说，其平均值为 $5+5+0+0 / 4 = 2.5$

- 将所有的平均评分收集到一个向量中，称为 $\mu$

- 进行归一化，将原始的评分数据减去各自的均值，得到归一化之后的评分数据

- 修改最终的预测：

  - 由于我们是在归一化之后的评分数据上进行训练模型的，则模型的输出可能会有负数，但为了最终的评分数据为非负数，则利用该模型进行预测时，还需要在模型的输出的基础上加上归一化时使用的均值（训练时可以不需要，即可以不更改模型，因为训练数据是归一化之后的数据）。

  - 即在测试时，对某个样本进行最终的预测时，应该在模型的输出的基础上再加上对应归一化时使用的均值：

    - $$
      \text{finally test predict} = \mathbf{w}^{(j)}·\mathbf{x}^{(i)}+b^{(j)}+\mu_i
      $$

通过 **均值归一化** 之后，再对未对任何内容进行评分的用户5进行评分预测时，由于我们最终的预测是在模型的输出上再加上 $\mu_i$，所以经过**均值归一化**之后的模型针对用户5对内容的评分的预测为各个内容评分的平均值，这比预测为0更加合理一些。

同时，通过**均值归一化**，该算法也将运行得更快一些。



